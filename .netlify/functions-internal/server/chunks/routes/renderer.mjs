import{createRenderer as e,getRequestDependencies as t,getPreloadLinks as n,getPrefetchLinks as r}from"vue-bundle-renderer/runtime";import{b as o,u as a,g as s,a as i,d,p as l,c as u,e as c,f as p,h,i as f,r as m,j as y,k as b}from"../nitro/nitro.mjs";import{renderToString as g}from"vue/server-renderer";import{createHead as w,propsToString as _,renderSSRHead as v}from"unhead/server";import{stringify as x,uneval as C}from"devalue";import{walkResolver as j}from"unhead/utils";import{toValue as S,isRef as T,hasInjectionContext as A,inject as R,ref as P,watchEffect as k,getCurrentInstance as $,onBeforeUnmount as H,onDeactivated as L,onActivated as O}from"vue";const VueResolver=(e,t)=>T(t)?S(t):t,U="usehead";function useHead(e,t={}){const n=t.head||function(){if(A()){const e=R(U);if(!e)throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.");return e}throw new Error("useHead() was called without provide context, ensure you call it through the setup() function.")}();return n.ssr?n.push(e||{},t):function(e,t,n={}){const r=P(!1);let o;k(()=>{const a=r.value?{}:j(t,VueResolver);o?o.patch(a):o=e.push(a,n)});$()&&(H(()=>{o.dispose()}),L(()=>{r.value=!0}),O(()=>{r.value=!1}));return o}(n,e,t)}function createHead(e={}){const t=w({...e,propResolvers:[VueResolver]});return t.install=function(e){return{install(t){t.config.globalProperties.$unhead=e,t.config.globalProperties.$head=e,t.provide(U,e)}}.install}(t),t}const M={meta:[{name:"viewport",content:"width=device-width, initial-scale=1"},{charset:"utf-8"},{"http-equiv":"X-UA-Compatible",content:"IE=edge"},{name:"format-detection",content:"telephone=no"},{name:"apple-mobile-web-app-capable",content:"yes"}],link:[],style:[],script:[],noscript:[],htmlAttrs:{lang:"en"},charset:"utf-8",viewport:"width=device-width, initial-scale=1"},z={id:"teleports"},N={id:"__nuxt-loader"},E=`<div${_({id:"__nuxt"})}>`,F="</div>",getClientManifest=()=>import("../build/client.manifest.mjs").then(e=>e.default||e).then(e=>"function"==typeof e?e():e),I=lazyCachedFunction(async()=>{const t=await getClientManifest();if(!t)throw new Error("client.manifest is not available");const n=await import("../build/server.mjs").then(e=>e.default||e);if(!n)throw new Error("Server bundle is not available");return e(n,{manifest:t,renderToString:async function(e,t){const n=await g(e,t);return E+n+F},buildAssetsURL:o})}),J=lazyCachedFunction(async()=>{const t=await getClientManifest(),n=await import("../virtual/_virtual_spa-template.mjs").then(e=>e.template).catch(()=>"").then(e=>{{const t=`<div${_(N)}>`;return E+F+(e?t+e+"</div>":"")}}),r=e(()=>()=>{},{manifest:t,renderToString:()=>n,buildAssetsURL:o}),s=await r.renderToString({});return{rendererContext:r.rendererContext,renderToString:e=>{const t=a(e.event);return e.modules||=new Set,e.payload.serverRendered=!1,e.config={public:t.public,app:t.app},Promise.resolve(s)}}});function lazyCachedFunction(e){let t=null;return()=>(null===t&&(t=e().catch(e=>{throw t=null,e})),t)}const X=lazyCachedFunction(()=>import("../build/styles.mjs").then(e=>e.default||e));function renderPayloadJsonScript(e){const t={type:"application/json",innerHTML:e.data?x(e.data,e.ssrContext._payloadReducers):"","data-nuxt-data":"nuxt-app","data-ssr":!e.ssrContext.noSSR,id:"__NUXT_DATA__"};e.src&&(t["data-src"]=e.src);return[t,{innerHTML:`window.__NUXT__={};window.__NUXT__.config=${C(e.ssrContext.config)}`}]}function splitPayload(e){const{data:t,prerenderedAt:n,...r}=e.payload;return{initial:{...r,prerenderedAt:n},payload:{data:t,prerenderedAt:n}}}const q={disableDefaults:!0};const B={omitLineBreaks:!0};globalThis.__buildAssetsURL=o,globalThis.__publicAssetsURL=l;const D=!!z.id,W=D?`<div${_(z)}>`:"",Y=D?"</div>":"",G=/^[^?]*\/_payload.json(?:\?.*)?$/;let K;const Q=d(async e=>{const d=b(),l=e.path.startsWith("/__nuxt_error")?u(e):null;if(l&&!("__unenv__"in e.node.req))throw c({statusCode:404,statusMessage:"Page Not Found: /__nuxt_error"});const g=function(e){return{url:e.path,event:e,runtimeConfig:a(e),noSSR:e.context.nuxt?.noSSR||!1,head:createHead(q),error:!1,nuxt:void 0,payload:{},_payloadReducers:Object.create(null),modules:new Set}}(e),w={mode:"server"};if(g.head.push(M,w),l){if(l.statusCode&&=Number.parseInt(l.statusCode),"string"==typeof l.data)try{l.data=p(l.data)}catch{}!function(e,t){e.error=!0,e.payload={error:t},e.url=t.url}(g,l)}const _=G.test(g.url);if(_){const t=g.url.substring(0,g.url.lastIndexOf("/"))||"/";g.url=t,e._path=e.node.req.url=t}const C=h(e);!1===C.ssr&&(g.noSSR=!0);const j=await function(e){return e.noSSR?J():I()}(g);for(const e of await getClientManifest().then(e=>{const t=[];for(const n of Object.values(e))n._globalCSS&&t.push(n.src);return t}))g.modules.add(e);const S=await j.renderToString(g).catch(async e=>{if(g._renderResponse&&"skipping render"===e.message)return{};const t=!l&&g.payload?.error||e;throw await(g.nuxt?.hooks.callHook("app:error",t)),t}),T=g._renderResponse||_?[]:await async function(e){const t=await X(),n=new Set;for(const r of e)if(r in t&&t[r])for(const e of await t[r]())n.add(e);return Array.from(n).map(e=>({innerHTML:e}))}(g.modules??[]);if(await(g.nuxt?.hooks.callHook("app:rendered",{ssrContext:g,renderResult:S})),g._renderResponse)return g._renderResponse;if(g.payload?.error&&!l)throw g.payload.error;if(_){const e=function(e){return{body:x(splitPayload(e).payload,e._payloadReducers),statusCode:i(e.event),statusMessage:s(e.event),headers:{"content-type":"application/json;charset=utf-8","x-powered-by":"Nuxt"}}}(g);return e}const A=C.noScripts,{styles:R,scripts:P}=t(g,j.rendererContext);if(!A){let t=K;t||(t=o("BeBuJCdP.js"),/^(?:\/|\.+\/)/.test(t)||f(t,{acceptRelative:!0})?K=t:(t=m(e.path.replace(/\/[^/]+$/,"/"),y("/",t)),/^(?:\/|\.+\/)/.test(t)||(t=`./${t}`))),g.head.push({script:[{tagPosition:"head",tagPriority:-2,type:"importmap",innerHTML:JSON.stringify({imports:{"#entry":t}})}]},w)}g._preloadManifest&&!A&&g.head.push({link:[{rel:"preload",as:"fetch",fetchpriority:"low",crossorigin:"anonymous",href:o(`builds/meta/${g.runtimeConfig.app.buildId}.json`)}]},{...w,tagPriority:"low"}),T.length&&g.head.push({style:T});const k=[];for(const e of Object.values(R))k.push({rel:"stylesheet",href:j.rendererContext.buildAssetsURL(e.file),crossorigin:""});if(k.length&&g.head.push({link:k},w),A||(g.head.push({link:n(g,j.rendererContext)},w),g.head.push({link:r(g,j.rendererContext)},w),g.head.push({script:renderPayloadJsonScript({ssrContext:g,data:g.payload})},{...w,tagPosition:"bodyClose",tagPriority:"high"})),!C.noScripts){const e="head";g.head.push({script:Object.values(P).map(t=>({type:t.module?"module":null,src:j.rendererContext.buildAssetsURL(t.file),defer:!t.module||null,tagPosition:e,crossorigin:""}))},w)}const{headTags:$,bodyTags:H,bodyTagsOpen:L,htmlAttrs:O,bodyAttrs:U}=await v(g.head,B),N={htmlAttrs:O?[O]:[],head:normalizeChunks([$]),bodyAttrs:U?[U]:[],bodyPrepend:normalizeChunks([L,g.teleports?.body]),body:[S.html,W+(D?joinTags([g.teleports?.[`#${z.id}`]]):"")+Y],bodyAppend:[H]};return await d.hooks.callHook("render:html",N,{event:e}),{body:(E=N,`<!DOCTYPE html><html${joinAttrs(E.htmlAttrs)}><head>${joinTags(E.head)}</head><body${joinAttrs(E.bodyAttrs)}>${joinTags(E.bodyPrepend)}${joinTags(E.body)}${joinTags(E.bodyAppend)}</body></html>`),statusCode:i(e),statusMessage:s(e),headers:{"content-type":"text/html;charset=utf-8","x-powered-by":"Nuxt"}};var E});function normalizeChunks(e){const t=[];for(const n of e){const e=n?.trim();e&&t.push(e)}return t}function joinTags(e){return e.join("")}function joinAttrs(e){return 0===e.length?"":" "+e.join(" ")}const V=Object.freeze(Object.defineProperty({__proto__:null,default:Q},Symbol.toStringTag,{value:"Module"}));export{U as h,V as r,useHead as u};
//# sourceMappingURL=renderer.mjs.map
